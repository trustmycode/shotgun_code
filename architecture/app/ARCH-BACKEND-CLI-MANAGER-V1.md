---
id: ARCH-BACKEND-CLI-MANAGER
title: "Бэкенд. Менеджер установки и выполнения Cursor CLI"
type: component
layer: infrastructure
owner: '@unassigned'
version: v1
status: planned
created: 2025-09-03
updated: 2025-09-03
tags: [backend, go, cli, wsl, cursor]
depends_on: []
referenced_by: []
---
## Контекст
Этот компонент является частью бэкенд-сервиса на Go и отвечает за полную инкапсуляцию логики взаимодействия с `cursor-agent` CLI. Его основная цель — обеспечить работу "из коробки", скрывая от пользователя сложность установки и кросс-платформенного вызова инструмента.

## Структура
Компонент будет реализован в `app.go` и будет состоять из трех основных публичных функций, доступных для фронтенда:
- `CheckCursorInstallation()`: Проверяет наличие `cursor-agent` в системе.
- `InstallCursorCli()`: Скачивает и выполняет официальный установочный скрипт.
- `ExecuteCliTool()`: Выполняет команду через `cursor-agent` с учетом особенностей ОС.

Внутренне компонент будет использовать пакеты `os/exec` для выполнения команд, `net/http` для скачивания скрипта и логику для определения ОС и наличия WSL.

## Поведение
1.  **Проверка установки**: `CheckCursorInstallation` будет искать исполняемый файл в `~/.cursor/bin/cursor-agent`. На Windows проверка будет осуществляться внутри WSL с помощью команды `wsl.exe test -f ...`. Функция возвращает статус (`installed`/`not_installed`) и путь к файлу.
2.  **Установка по требованию**: Если CLI не найден, фронтенд вызовет `InstallCursorCli`. Эта функция скачает скрипт с `https://cursor.com/install` во временный файл, запросит подтверждение у пользователя (через UI) и выполнит его. На Windows скрипт будет выполняться внутри WSL.
3.  **Выполнение команды**: `ExecuteCliTool` будет принимать путь к исполняемому файлу (полученный от `CheckCursorInstallation`). На Windows она будет транслировать пути к файлам проекта в формат WSL (`/mnt/c/...`) и выполнять команду через `wsl.exe`. На macOS/Linux команда будет выполняться нативно.

## Эволюция
### Планируется
- Добавление механизма проверки обновлений для Cursor CLI.
- Поддержка альтернативных путей установки.

### История
- v1: Первоначальный дизайн, ориентированный на установку по требованию и поддержку WSL.

