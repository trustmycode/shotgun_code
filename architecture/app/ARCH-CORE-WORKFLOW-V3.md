---
id: ARCH-CORE-WORKFLOW
title: "Основной рабочий процесс приложения v3 (Codex CLI)"
type: feature
layer: application
owner: '@AI-DocArchitect'
version: v3
status: planned
created: 2025-09-04
updated: 2025-09-04
tags: [workflow, cli, codex-cli]
depends_on: [ARCH-BACKEND-CLI-MANAGER, ARCH-FRONTEND-CLI-UI]
referenced_by: []
---
## Контекст
Этот документ описывает планируемый рабочий процесс приложения после рефакторинга, в рамках которого `cursor-agent` CLI заменяется на `codex-cli` от OpenAI. Основное изменение касается Шага 4, где добавляется явный процесс установки и авторизации для нового инструмента.

## Структура
Новый рабочий процесс на Шаге 4 будет включать проверку установки `codex-cli`, его установку через `npm`, проверку авторизации и запуск процесса входа в новом окне терминала.

## Поведение

```mermaid
graph TD
    subgraph "Шаг 4: Выполнение"
        A[Вход на Шаг 4] --> B{Проверка Codex CLI};
        B -- Не найден --> C[UI: Предложить установку];
        C -- Пользователь согласен --> D[Бэкенд: npm install -g @openai/codex];
        D -- Успешно --> E{Проверка авторизации};
        D -- Ошибка --> F[UI: Показать ошибку установки];
        B -- Найден --> E;
        E -- Не авторизован --> G[UI: Предложить авторизацию];
        G -- Пользователь нажимает "Войти" --> H[Бэкенд: запуск 'codex' в новом окне терминала];
        H --> I[UI: "Ожидаем завершения входа..."];
        I -- Пользователь нажимает "Я вошел" --> J[Бэкенд: повторная проверка авторизации];
        J -- Успешно --> K[UI: Готов к выполнению];
        J -- Ошибка --> G;
        E -- Авторизован --> K;
        K -- Выполнить --> L[Бэкенд: codex exec "prompt"];
        L --> M[UI: Отобразить результат];
    end
```

## Эволюция
### Планируется
- Полная замена `cursor-agent` на `codex-cli`.
- Внедрение нового потока авторизации с использованием внешнего терминала.

### Историческая
- v3: Планирование перехода на `codex-cli`.
