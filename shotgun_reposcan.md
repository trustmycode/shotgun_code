{"contexts":{"ShotgunApp":{"description":"A desktop tool that packages an entire project's source code into a single, large text payload for use with Large Language Models (LLMs). It aims to solve the problem of providing complete context to AI assistants for tasks like large-scale refactoring, bug fixing, and documentation generation.","c4_level":"Context"}},"containers":{"WailsApp":{"description":"Основной контейнер приложения, представляющий собой кроссплатформенное десктопное приложение, созданное с помощью фреймворка Wails. Он объединяет в себе бэкенд на Go и фронтенд на Vue.js в единый исполняемый файл. Этот контейнер отвечает за предоставление пользовательского интерфейса, обработку файловых операций и генерацию 'контекстного payload' для LLM.","technology_stack":["Go (Backend)","Vue.js v3 (Frontend)","Wails v2 (Framework)","embed.FS (for bundling frontend assets)"],"responsibilities":["Предоставление графического пользовательского интерфейса (GUI) для выбора проекта и управления файлами.","Сканирование файловой системы для построения дерева проекта.","Применение правил игнорирования (.gitignore, кастомные правила).","Генерация единого текстового файла ('Context Payload') из выбранных файлов проекта.","Взаимодействие с буфером обмена операционной системы.","Наблюдение за изменениями в файловой системе проекта."],"communication_mechanisms":["Взаимодействие между Go и Vue.js осуществляется через JavaScript-биндинги, автоматически генерируемые Wails. Методы Go, привязанные в `main.go`, могут быть вызваны напрямую из JavaScript как асинхронные функции. Wails также предоставляет систему событий для асинхронной отправки данных от бэкенда к фронтенду."],"c4_level":"Container"}},"domain_glossary":{"Shotgun":{"description":"The name of the application, used as a metaphor for a 'whole-repository blast' - packaging the entire codebase into a single payload for an LLM.","c4_level":"Context"},"LLM":{"description":"Large Language Model. The primary consumer of the output generated by the Shotgun App. Examples include ChatGPT, Gemini, etc.","c4_level":"Context"},"Context Payload":{"description":"The structured text output generated by the application, containing a file tree representation and the contents of all included files, formatted for easy parsing by an LLM.","c4_level":"Context"},"Wails":{"description":"A framework for building cross-platform desktop applications with a Go backend and a web-based frontend. It handles the communication between Go and JavaScript.","c4_level":"Context"}},"deployment_topology":{"desktop_app":{"description":"The system is a single, cross-platform (Windows, macOS, Linux) desktop application.","type":"Desktop Application","technology_stack":["Go (Backend)","Vue.js v3 (Frontend)","Wails v2 (Framework)"],"communication":"The Go backend and Vue.js frontend communicate via Wails bindings, which bridge Go functions to JavaScript calls.","c4_level":"Container"},"development_environment":{"description":"The development and build environment requires Go (>=1.20), Node.js (LTS), and the Wails CLI tool.","c4_level":"Container"}},"data_schema":{"FileNode":{"description":"Represents a single file or directory in the project tree. This structure is serialized to JSON and sent to the frontend to render the file explorer.","fields":{"name":"string // The base name of the file or directory.","path":"string // The full, absolute path on the file system.","relPath":"string // The path relative to the project root.","isDir":"bool // True if the node is a directory.","children":"array[FileNode] // A list of child nodes, present if isDir is true.","isGitignored":"bool // True if the path is matched by a .gitignore rule.","isCustomIgnored":"bool // True if the path is matched by a custom user-defined ignore rule."},"c4_level":"Component"},"AppSettings":{"description":"Represents the user's configuration, which is persisted to `settings.json`.","fields":{"customIgnoreRules":"string // A multi-line string containing glob patterns for custom file/directory ignoring.","customPromptRules":"string // A string containing user-defined rules or instructions to be included in LLM prompts."},"c4_level":"Component"}},"components":{"GoBackend":{"description":"The core backend logic of the Shotgun App, written in Go. It runs within the Wails container and is responsible for all file system operations, context generation, and configuration management. It exposes its methods to the Vue.js frontend via Wails bindings.","technology_stack":["Go","Wails v2","fsnotify","go-gitignore"],"responsibilities":["Providing an API for the frontend to interact with the file system.","Scanning project directories and building a file tree structure.","Applying .gitignore and custom ignore rules to filter files.","Asynchronously generating a large text payload ('Context Payload') from selected files.","Watching the file system for changes and notifying the frontend.","Managing user settings (custom ignore/prompt rules) via a JSON config file.","Providing utility functions like splitting Git diffs and handling clipboard operations in WSL."],"c4_level":"Component","subcomponents":{"FileSystemManager":{"description":"Handles scanning of project directories, building a hierarchical file tree (`FileNode` structure), and applying ignore rules from both `.gitignore` files and custom user-defined patterns.","responsibilities":["Opening a directory selection dialog.","Recursively listing files and directories.","Parsing `.gitignore` files.","Compiling and matching custom ignore patterns.","Constructing the `FileNode` tree with ignore status flags for the frontend.","Применение глобальных правил игнорирования из файла `ignore.glob`."],"c4_level":"Component"},"ContextPayloadGenerator":{"description":"Manages the asynchronous generation of the final 'Context Payload' text. It runs in a separate goroutine to avoid blocking the UI, provides progress updates, and handles cancellation.","responsibilities":["Receiving a request from the frontend to generate context for a given directory and a list of excluded paths.","Counting the total number of files to process for progress tracking.","Building a text-based file tree representation.","Reading the content of all included files.","Concatenating the tree and file contents into a single string, formatted with `<file>` tags.","Enforcing a maximum output size to prevent crashes.","Emitting events to the frontend for progress, success (`shotgunContextGenerated`), or error (`shotgunContextError`)."],"c4_level":"Component"},"FileSystemWatcher":{"description":"Implemented as the 'Watchman'. It uses `fsnotify` to monitor the selected project directory for any file system changes (create, write, remove, rename).","responsibilities":["Starting and stopping the file watcher on demand.","Recursively adding all non-ignored directories to the watcher.","Listening for `fsnotify` events.","Ignoring events for paths that match active ignore rules.","Emitting a `projectFilesChanged` event to the frontend upon detecting a relevant change, prompting a UI refresh.","Dynamically updating watched directories when ignore rules change."],"c4_level":"Component"},"ConfigurationManager":{"description":"Manages the loading and saving of user preferences, stored in a `settings.json` file in the user's standard config directory (XDG path).","responsibilities":["Defining the `AppSettings` data structure.","Loading settings on startup, falling back to embedded defaults if the file doesn't exist.","Saving settings to disk whenever they are modified.","Providing methods for the frontend to get and set custom ignore rules and custom prompt rules.","Re-compiling ignore patterns and refreshing the `FileSystemWatcher` when rules change."],"c4_level":"Component"},"DiffProcessor":{"description":"A utility component responsible for processing and manipulating Git diff text.","responsibilities":["Parsing a large Git diff string.","Splitting the diff into smaller chunks based on a specified line limit.","Prioritizing splits between files, and then between hunks if a single file's diff is too large.","Implementing an advanced merging logic to recombine small chunks into optimally sized final diffs."],"c4_level":"Component"}}},"VueFrontend":{"description":"Пользовательский интерфейс приложения, созданный как одностраничное приложение (SPA) на Vue.js 3. Он работает внутри Wails webview и отвечает за всю логику взаимодействия с пользователем. Фронтенд общается с бэкендом на Go через биндинги Wails для выполнения файловых операций и других основных задач.","c4_level":"Component","technology_stack":["Vue.js v3 (Composition API)","Vite","TailwindCSS","Wails v2 JavaScript runtime"],"responsibilities":["Предоставление многошагового пользовательского интерфейса для основного рабочего процесса (Подготовка контекста -> Составление промпта -> Выполнение -> Применение патча).","Выбор пользователем директории проекта.","Отображение файловой структуры проекта в виде иерархического интерактивного дерева.","Предоставление пользователям возможности включать/исключать файлы и папки из контекста, используя .gitignore, пользовательские правила и ручное переключение.","Отображение сгенерированного бэкендом контекстного payload.","Предоставление интерфейса для составления финального промпта для LLM путем комбинирования пользовательского ввода, правил и контекста проекта.","Обработка и отображение разделенных git-диффов для упрощения их применения.","Отображение логов и обновлений прогресса от бэкенда."],"subcomponents":{"MainLayout":{"description":"Центральный компонент-оркестратор, который управляет общим состоянием UI, обрабатывает события от дочерних компонентов и взаимодействует с бэкендом Go через Wails.","c4_level":"Component"},"LeftSidebar":{"description":"Боковая панель, содержащая элементы управления для выбора проекта, настройки правил игнорирования (.gitignore, кастомные) и отображения дерева файлов.","c4_level":"Component"},"FileTree":{"description":"Рекурсивный компонент, отображающий иерархию файлов и папок проекта с чекбоксами для включения/исключения.","c4_level":"Component"},"CentralPanel":{"description":"Основная область контента, которая динамически отображает компонент текущего шага рабочего процесса (Step1-Step4).","c4_level":"Component"},"BottomConsole":{"description":"Панель в нижней части экрана для вывода логов выполнения операций и статуса приложения.","c4_level":"Component"},"HorizontalStepper":{"description":"Верхняя панель навигации, которая визуализирует шаги основного рабочего процесса и позволяет перемещаться между ними.","c4_level":"Component"},"StepComponents":{"description":"Набор компонентов (`Step1PrepareContext`, `Step2ComposePrompt`, `Step3ExecutePrompt`, `Step4ApplyPatch`), каждый из которых представляет собой отдельный экран для каждого этапа рабочего процесса.","c4_level":"Component"},"CustomRulesModal":{"description":"Переиспользуемое модальное окно для редактирования текстовых правил (как для игнорирования файлов, так и для составления промптов).","c4_level":"Component"}}}},"external_integrations":{},"testing_strategy":{}}